# Telco Billing Customer Care Agent Configuration
# 
# This is the primary configuration file for the billing agent.
# 
# SECURITY NOTE: Sensitive values (warehouse_id, endpoints) should be 
# managed via Databricks Secrets in production. See 000-config.py for
# the secure configuration pattern.
#
# For production deployment, update these values to match your environment
# or override via environment variables.

# Unity Catalog Configuration
catalog: telco_billing_dev
schema: billing_customer_care

# LLM Configuration
llm_endpoint: databricks-claude-3-7-sonnet
llm_timeout_seconds: 60
llm_max_tokens: 1024

# Embedding Model Configuration  
embedding_model_endpoint_name: databricks-gte-large-en

# Warehouse Configuration (for UC function execution)
# In production, retrieve this from Databricks Secrets
warehouse_id: "148ccb90800933a1"

# Vector Search Configuration
vector_search_index: telco_billing_dev.billing_customer_care.faq_indx1

# Unity Catalog Tools
# These functions are defined in 02_define_uc_tools.py with input validation
tools_billing_faq: telco_billing_dev.billing_customer_care.billing_faq
tools_billing: telco_billing_dev.billing_customer_care.lookup_billing
tools_items: telco_billing_dev.billing_customer_care.lookup_billing_items
tools_plans: telco_billing_dev.billing_customer_care.lookup_billing_plans
tools_customer: telco_billing_dev.billing_customer_care.lookup_customer

# Agent Configuration
agent_name: ai_billing_agent

# Agent System Prompt
# This prompt guides the agent's behavior and ensures security compliance
agent_prompt: |
  You are a Billing Support Agent assisting users with billing inquiries for a telecommunications provider.

  ## Guidelines:
  - First, check FAQ Search before requesting any customer details.
  - If an FAQ answer exists, return it immediately.
  - If no FAQ match, request the customer_id before retrieving billing details.
  - NEVER disclose confidential information like names, emails, device_id, or phone numbers.
  - Always be polite, professional, and concise.

  ## Security Rules:
  - Only provide billing summaries and plan information.
  - If asked for sensitive data (SSN, full credit card, etc.), politely decline.
  - If a customer_id appears invalid, ask for verification.

  ## Process:
  1. Run FAQ Search -> If an answer exists, return it.
  2. If no FAQ match, ask for the customer_id.
  3. Use the relevant tool(s) to fetch billing details.
  4. If missing details (e.g., timeframe), ask clarifying questions.
  5. Summarize the billing information clearly.

  ## Available Tools:
  - billing_faq: Search FAQs for common billing questions
  - lookup_customer: Get customer details (use only to verify customer exists)
  - lookup_billing: Get monthly billing summary for a customer
  - lookup_billing_items: Get detailed billing events (data, calls, texts)
  - lookup_billing_plans: List all available billing plans

# Model Lifecycle Aliases (for MLflow model registry)
model_alias_champion: champion
model_alias_challenger: challenger
model_alias_archived: archived

# Permission Groups (for governance)
admin_group: telco_billing_admins
data_engineer_group: telco_billing_data_engineers
data_scientist_group: telco_billing_data_scientists
agent_service_principal: telco_billing_agent_sp

# =============================================================================
# Agent Bricks Configuration
# =============================================================================
# Agent Bricks provides a declarative approach to building AI agents with
# automatic optimization, evaluation, and multi-agent coordination.

# Knowledge Assistant Configuration
agent_bricks:
  # Knowledge Assistant settings
  knowledge_assistant:
    name: telco-billing-faq-assistant
    description: "Answers customer questions about telecom billing, plans, and payments"
    # Knowledge source - can be UC Files (volume path) or Vector Search Index
    knowledge_source_type: uc_files  # Options: uc_files, vector_search
    knowledge_source_path: billing_faq_docs  # Volume name or VS index
    instructions: |
      You are a friendly and helpful billing support assistant.
      - Always cite your sources when providing information
      - If you don't know the answer, say so clearly
      - Never make up information or guess
      - Be concise but thorough
      - Never provide or confirm personal account information

  # Multi-Agent Supervisor Configuration
  multi_agent_supervisor:
    name: telco-billing-supervisor
    description: "Coordinates billing assistants to handle complex customer inquiries"
    instructions: |
      You are a supervisor coordinating multiple billing support agents.
      1. First, try the FAQ Knowledge Assistant for general questions
      2. If the customer provides a customer ID, use the billing lookup tools
      3. For plan comparisons, use the plans lookup tool
      4. For complex queries, coordinate multiple agents
      Always verify customer ID before providing account details.
    
    # Subagents to coordinate (configured in UI)
    subagents:
      - type: knowledge_assistant
        name: telco-billing-faq-assistant
        description: "Handles FAQ and general billing questions"
      - type: uc_function
        name: lookup_billing
        description: "Gets monthly billing summary for customers"
      - type: uc_function
        name: lookup_billing_items
        description: "Gets detailed billing line items"
      - type: uc_function
        name: lookup_billing_plans
        description: "Lists available billing plans"
      - type: uc_function
        name: lookup_customer
        description: "Verifies customer accounts"
